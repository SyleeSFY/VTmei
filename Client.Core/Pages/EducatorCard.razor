@page "/EducatorCard/{id:int}"
@using Client.Core.Shared.Models
<h3>EducatorCard</h3>
@inject HttpClient Http

<h3 style="margin-top: 100px">Карточка преподавателя</h3>

@if (isLoading)
{
    <p>Загрузка...</p>
}
else if (educator != null)
{
    <div style="margin-top: 20px">
        <p>ID: @educator.Id</p>
        <p>ФИО: @educator.FullName</p>
        <a href="/contacts" class="btn btn-secondary">Назад к контактам</a>
    </div>
}
else if (errorMessage != null)
{
    <p style="color: red;">Ошибка: @errorMessage</p>
    <a href="/contacts" class="btn btn-secondary">Назад</a>
}

@code {
    [Parameter]
    public int Id { get; set; }
    
    private Educator? educator;
    private bool isLoading = true;
    private string? errorMessage;
    
    protected override async Task OnInitializedAsync()
    {
        await LoadEducator();
    }
    
    private async Task LoadEducator()
    {
        isLoading = true;
        try
        {
            educator = await Http.GetFromJsonAsync<Educator>($"api/educators/{Id}");
        }
        catch (Exception ex)
        {
            errorMessage = ex.Message;
        }
        finally
        {
            isLoading = false;
        }
    }
}